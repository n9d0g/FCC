if (self.CavalryLogger) { CavalryLogger.start_js(["zYaSQ"]); }

__d("oz-player/drm/OzDrmUtils",[],(function(a,b,c,d,e,f){"use strict";a=function(a){return Uint8Array.from(window.atob(a),function(a){return a.charCodeAt(0)})};b=function(a){return window.btoa(String.fromCharCode.apply(null,new Uint8Array(a)))};e.exports={base64ToUint8Array:a,arrayBufferToBase64:b}}),null);
__d("OzWidevineDrmProvider",["URI","oz-player/drm/OzDrmUtils"],(function(a,b,c,d,e,f){"use strict";var g,h=b("oz-player/drm/OzDrmUtils").arrayBufferToBase64,i=b("oz-player/drm/OzDrmUtils").base64ToUint8Array;a=function(){function a(a,c,d,e,f){this.$2=[];this.$4=!0;this.$5=!1;f!==void 0&&f!==null&&f!==""&&(this.$1=i(f));if(c!==null&&c!==void 0&&e!==null&&e!==void 0){f=new(g||(g=b("URI")))(c);f.addQueryData("access_token",e);this.$3=f.toString();this.$5=!0;this.$4=!1}else{c=d["0"];if(c===void 0||c===null){c="/video/drm/getlicense";e=new(g||(g=b("URI")))(c);e.addQueryData("video_id",a);this.$3=e.toString()}else this.$3=c}}var c=a.prototype;c.getKeySystem=function(){return"com.widevine.alpha"};c.getSchemeId=function(){return"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};c.getInitDatas=function(){return this.$2};c.setInitDatas=function(a){this.$2=a};c.getRequireDistinctiveIdentifier=function(){return"optional"};c.getRequirePersistentState=function(){return"optional"};c.getInitDataTypes=function(){return};c.getDrmSessionTypes=function(){return["temporary"]};c.getAudioRobustness=function(){return""};c.getVideoRobustness=function(){return""};c.getServerCertificate=function(){return this.$1};c.getLicenseRequestInfo=function(a){var b={url:this.$3,method:"POST",body:"",headers:{}};this.$4&&(b.credentials="include");a=h(a);if(this.$5){var c={request:a};b.body=JSON.stringify(c);b.headers["Content-Type"]="application/json"}else b.body=a,b.headers["Content-Type"]="application/text";return b};c.parseLicenseResponse=function(a){a=String.fromCharCode.apply(null,a);var b;try{b=JSON.parse(a)}catch(a){b=void 0}var c;if(b!==void 0&&b.data!==void 0&&b.data.length===1){b=b.data[0];b.error!==null&&b.error!==void 0||(c=b.license)}else c=a;return c!==void 0&&c!==null&&c!==""?i(c):null};return a}();e.exports=a}),null);
__d("oz-player/drm/OzDrmManager",["oz-player/loggings/OzLoggingUtils","oz-player/loggings/OzOperationLoggerBase","oz-player/shims/OzDOMEventListener","oz-player/shims/OzMaybeNativePromise","oz-player/shims/OzSubscriptionsHandler","oz-player/utils/OzError","oz-player/utils/OzErrorEmitter","oz-player/drm/OzDrmUtils"],(function(a,b,c,d,e,f){"use strict";var g=b("oz-player/loggings/OzLoggingUtils").monitorPromiseAndLogOperation,h=b("oz-player/shims/OzDOMEventListener").listenDOMEvent,i=b("oz-player/drm/OzDrmUtils").base64ToUint8Array;a=function(){function a(a,c){var d=this;this.$1=new Map();this.$3=!1;this.$5=new(b("oz-player/shims/OzSubscriptionsHandler"))();this.$6=new(b("oz-player/utils/OzErrorEmitter"))();this.$7=!1;this.$8=null;this.$9=function(a){var c=a;a instanceof b("oz-player/utils/OzError")||(c=new(b("oz-player/utils/OzError"))({type:"OZ_DRM_MANAGER",description:a.message,extra:{originalError:a}}));d.$6.emitError(c)};this.$4=c;this.$2=a.cloneContext().setType("drm_manager")}var c=a.prototype;c.hasContentProtections=function(){return this.$8};c.onError=function(a){return this.$6.onError(a)};c.addProvider=function(a){this.$1.set(a.getSchemeId(),a)};c.getProviderForSchemeId=function(a){return this.$1.get(a)};c.parseContentProtectionForRepresentation=function(a){if(!a.ContentProtection)return null;var b=[];for(var c=0;c<a.ContentProtection.length;c++){var d=a.ContentProtection[c],e=d.$.schemeIdUri;e=this.getProviderForSchemeId(e);if(e){var f=e.getInitDatas();if(f.length==0&&d["cenc:pssh"]&&d["cenc:pssh"].length===1){d=d["cenc:pssh"][0]._;d=i(d.replace(/-/g,"+").replace(/_/g,"/"));f=[{data:d,type:"cenc"}];e.setInitDatas(f)}b.push({provider:e,initDatas:f})}}return b};c.startEME=function(a,b,c,d){var e=this;if(this.$7)return;this.$7=!0;var f=new Map();this.$10(c,d,f,"audio");this.$10(a,b,f,"video");var g;f.forEach(function(a,b){!g?g=e.$11(b,a):g=g["catch"](function(){return e.$11(b,a)})});if(!g){this.$8=!1;return}this.$8=!0;var h=this.$2.getOperationLogger("drm_setup").start();g.then(this.$12.bind(this)).then(this.$13.bind(this)).then(this.$14.bind(this)).then(function(){return h.log()},function(a){e.$9(a),h.setResult("failed").setError(a).log()})};c.$15=function(a){a instanceof b("oz-player/loggings/OzOperationLoggerBase")&&a.getError()&&a.setResult("failed")};c.$10=function(a,b,c,d){var e=this;b.forEach(function(b){var f;a&&a.ContentProtection?f=e.parseContentProtectionForRepresentation(a):f=b.getCustomField("drmProtections");var g=b.getMimeCodecs();f!==void 0&&f!==null&&f.forEach(function(a){a=a.provider;c.has(a.getKeySystem())||c.set(a.getKeySystem(),{audioCapabilities:new Map(),videoCapabilities:new Map(),distinctiveIdentifier:a.getRequireDistinctiveIdentifier(),persistentState:a.getRequirePersistentState(),sessionTypes:a.getDrmSessionTypes(),initDataTypes:a.getInitDataTypes()});var b=c.get(a.getKeySystem());d==="audio"&&!b.audioCapabilities.has(g)&&b.audioCapabilities.set(g,{contentType:g,robustness:a.getAudioRobustness()});d==="video"&&!b.videoCapabilities.has(g)&&b.videoCapabilities.set(g,{contentType:g,robustness:a.getVideoRobustness()})})})};c.destroy=function(){this.$5.release(),this.$3=!0};c.$11=function(a,b){b={audioCapabilities:Array.from(b.audioCapabilities.values()),videoCapabilities:Array.from(b.videoCapabilities.values()),distinctiveIdentifier:b.distinctiveIdentifier,persistentState:b.persistentState,sessionTypes:b.sessionTypes,initDataTypes:b.initDataTypes};return g(window.navigator.requestMediaKeySystemAccess(a,[b]),this.$2,"drm_request_media_key_system_access",function(){},this.$15)};c.$12=function(a){return this.$3?b("oz-player/shims/OzMaybeNativePromise").reject():g(a.createMediaKeys().then(function(b){return{mediaKeySystemAccess:a,mediaKeys:b}}),this.$2,"drm_create_media_keys",function(){},this.$15)};c.$13=function(a){var c=this;if(this.$3)return b("oz-player/shims/OzMaybeNativePromise").reject();var d=a.mediaKeySystemAccess,e=a.mediaKeys;if(!e)throw new(b("oz-player/utils/OzError"))({type:"OZ_DRM_MANAGER",description:"No mediaKeys for mediaKeySystemAccess"});a=this.$4.setMediaKeys(e).then(function(){if(c.$3)return b("oz-player/shims/OzMaybeNativePromise").reject();var a=Array.from(c.$1.values()).find(function(a){return a.getKeySystem()===d.keySystem});if(!a)throw new(b("oz-player/utils/OzError"))({type:"OZ_DRM_MANAGER",description:"Can't find OzDrmProvider for keySystem "+d.keySystem});var f=a.getServerCertificate();return f?e.setServerCertificate(f).then(function(){return{mediaKeySystemAccess:d,mediaKeys:e,provider:a}}):{mediaKeys:e,provider:a}});return g(a,this.$2,"drm_set_media_keys",function(){},this.$15)};c.$14=function(a){var c=this,d=a.mediaKeys,e=a.provider;a=e.getInitDatas();if(a.length===0){this.$5.addSubscriptions(h(this.$4,"encrypted",function(a){c.$16(d,e,a)["catch"](c.$9)}));return b("oz-player/shims/OzMaybeNativePromise").resolve([])}a=a.map(function(a){return c.$16(d,e,{initData:a.data,initDataType:a.type})});return g(b("oz-player/shims/OzMaybeNativePromise").all(a),this.$2,"drm_request_license",function(){},this.$15)};c.$16=function(a,b,c){var d=this,e=a.createSession();this.$5.addSubscriptions(h(e,"message",function(a){d.$17(e,b,a)["catch"](d.$9)}),h(e,"keystatuseschange",function(a){d.$18(e)["catch"](d.$9)}));return e.generateRequest(c.initDataType,c.initData)};c.$17=function(a,b,c){var d=this;c=b.getLicenseRequestInfo(c.message.slice(0));return window.fetch(c.url,c).then(function(a){return a.arrayBuffer()}).then(function(c){c=new Uint8Array(c);c=b.parseLicenseResponse(c);c===null||c===void 0||c.byteLength===0?d.$9(new Error("No license for "+b.getKeySystem())):a.update(c)})};c.$18=function(a){return a.expiration<Date.now()?a.close():b("oz-player/shims/OzMaybeNativePromise").resolve()};return a}();e.exports={OzDrmManager:a}}),null);
__d("HTML5OzDrmHelper",["OzWidevineDrmProvider","oz-player/drm/OzDrmManager"],(function(a,b,c,d,e,f){"use strict";a=b("oz-player/drm/OzDrmManager").OzDrmManager;c={OzDrmManagerModule:a,OzWidevineDrmProviderModule:b("OzWidevineDrmProvider")};e.exports=c}),null);